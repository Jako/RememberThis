/*!
 * RememberThis - Remember List for xPDO Objects
 * Version: 2.0.2
 * Build date: 2017-10-04
 */

!function(e,t,n,o){function i(t,n,o){this.options=e.extend({},s,n),this._defaults=s,this._name=a,this.$el=e(t),this.$other=e(this.options.listSelector).not(this.$el),this.init(o)}var a="rememberThis",s={ajaxLoaderImg:"",listSelector:".rememberthis",onBeforeAdd:function(e,t,n,o,i){},onBeforeDelete:function(e,t,n,o,i){},onAfterAdd:function(e,t,n,o,i){},onAfterDelete:function(e,t,n,o,i){}};i.prototype={init:function(t){var n=this;""!==n.options.ajaxLoaderImg?n.options.loadImage=e("<img>").addClass("rememberload").attr("src",n.options.ajaxLoaderImg):n.options.loadImage=e("<i>").addClass("fa fa-refresh fa-spin rememberload"),t&&(e(".rememberadd").on("click",function(t){t.preventDefault();var o=e(this).data("add"),i=e(this).data();delete i.add,e(this).append(n.options.loadImage.clone()),n.options.onBeforeAdd.call(n.$el,n.$other,this,o,i),n.onAdd(n.$el,n.$other,this,o,i),n.options.onAfterAdd.call(n.$el,n.$other,this,o,i)}),e(".rememberaddform").on("submit",function(t){t.preventDefault();var o=e(this).data("add"),i={};e.each(e(this).serializeArray(),function(e,t){i.hasOwnProperty(t.name)?("string"==typeof i[t.name]&&(i[t.name]=[i[t.name]]),i[t.name].push(t.value)):i[t.name]=t.value}),e(this).append(n.options.loadImage.clone()),n.options.onBeforeAdd.call(n.$el,n.$other,this,o,i),n.onAdd(n.$el,n.$other,this,o,i),n.options.onAfterAdd.call(n.$el,n.$other,this,o,i)})),n.$el.on("click",".rememberdelete",function(t){t.preventDefault();var o=e(this).data("delete");e(this).hide().after(n.options.loadImage.clone()),n.options.onBeforeDelete.call(n.$el,n.$other,this,o),n.onDelete(n.$el,n.$other,this,o),n.options.onAfterDelete.call(n.$el,n.$other,this,o)})},onAdd:function(t,n,o,i,a){var s=this;e.ajax({type:"GET",url:s.options.connectorUrl,data:{language:s.options.language,action:"remember",add:i,addproperties:a},success:function(o){if(e(".rememberload").remove(),o.result)if(e(".rememberempty",t).length)t.slideUp("fast",function(){e(".remembercount").html(o.count),e(this).html(o.result).slideDown("slow")}),n.length&&n.each(function(){e(this).slideUp("fast",function(){e(this).html(e.trim(o.result)).slideDown("slow")})});else{var i=e(o.result).attr("style","display: none");t.append(i),e(".remembercount").html(o.count),n.length&&n.each(function(){var t=i.clone();e(this).append(t),t.slideDown("slow")}),i.slideDown("slow")}o.debug&&e(".rememberdebug").html(o.debug)}})},onDelete:function(t,n,o,i){var a=this;e.ajax({type:"GET",url:a.options.connectorUrl,data:{language:a.options.language,action:"remember",delete:i},success:function(i){if(i.count&&"0"!==i.count){var a=e(o).parent(),s=a.index();a.slideUp("slow",function(){e(".remembercount").html(i.count),e(this).remove()}),n.length&&n.each(function(){e(this).children().eq(s).slideUp("slow",function(){e(this).remove()})})}else t.slideUp("slow",function(){e(".remembercount").html(i.count),e(this).html(e.trim(i.result)).slideDown("fast")}),n.length&&n.each(function(){e(this).slideUp("slow",function(){e(this).html(e.trim(i.result)).slideDown("fast")})});i.debug&&e(".rememberdebug").html(i.debug)}})}},e.fn[a]=function(t){var n=arguments;if(void 0===t||"object"==typeof t){var o=!0;return this.each(function(){e.data(this,"plugin_"+a)||e.data(this,"plugin_"+a,new i(this,t,o)),o=!1})}if("string"==typeof t&&"_"!==t[0]&&"init"!==t){var s;return this.each(function(){var o=e.data(this,"plugin_"+a);o instanceof i&&"function"==typeof o[t]&&(s=o[t].apply(o,Array.prototype.slice.call(n,1))),"destroy"===t&&e.data(this,"plugin_"+a,null)}),void 0!==s?s:this}}}(jQuery,window,document);