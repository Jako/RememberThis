/*!
 * RememberThis - Remember List for xPDO Objects
 * Version: 2.2.0
 * Build date: 2018-07-05
 */

!function(e,t,n,o){var i="rememberThis",s={ajaxLoaderImg:"",listSelector:".rememberthis",onBeforeAdd:function(e,t,n,o,i){},onBeforeDelete:function(e,t,n,o,i){},onAfterAdd:function(e,t,n,o,i){},onAfterDelete:function(e,t,n,o,i){}};function a(t,n,o){this.options=e.extend({},s,n),this._defaults=s,this._name=i,this.$el=e(t),this.$other=e(this.options.listSelector).not(this.$el),this.init(o)}a.prototype={init:function(t){var o=this;""!==o.options.ajaxLoaderImg?o.options.loadImage=e("<img>").addClass("rememberload").attr("src",o.options.ajaxLoaderImg):o.options.loadImage=e("<i>").addClass("fa fa-refresh fa-spin rememberload"),t&&(e(n).on("click",".rememberadd",function(t){t.preventDefault();var n=e(this).data("add"),i=e(this).data();delete i.add,e(this).append(o.options.loadImage.clone()),o.options.onBeforeAdd.call(o.$el,o.$other,this,n,i),o.onAdd(o.$el,o.$other,this,n,i),o.options.onAfterAdd.call(o.$el,o.$other,this,n,i)}),e(n).on("submit",".rememberaddform",function(t){t.preventDefault();var n=e(this).data("add"),i={};e.each(e(this).serializeArray(),function(e,t){i.hasOwnProperty(t.name)?("string"==typeof i[t.name]&&(i[t.name]=[i[t.name]]),i[t.name].push(t.value)):i[t.name]=t.value}),e(this).append(o.options.loadImage.clone()),o.options.onBeforeAdd.call(o.$el,o.$other,this,n,i),o.onAdd(o.$el,o.$other,this,n,i),o.options.onAfterAdd.call(o.$el,o.$other,this,n,i)})),o.$el.on("click",".rememberdelete",function(t){t.preventDefault();var n=e(this).data("delete");e(this).hide().after(o.options.loadImage.clone()),o.options.onBeforeDelete.call(o.$el,o.$other,this,n),o.onDelete(o.$el,o.$other,this,n),o.options.onAfterDelete.call(o.$el,o.$other,this,n)})},onAdd:function(t,n,o,i,s){e.ajax({type:"GET",url:this.options.connectorUrl,data:{language:this.options.language,action:"remember",add:i,addproperties:s},success:function(o){if(e(".rememberload").remove(),o.result)if(e(".rememberempty",t).length)t.slideUp("fast",function(){e(".remembercount").html(o.count),e(this).html(o.result).slideDown("slow")}),n.length&&n.each(function(){e(this).slideUp("fast",function(){e(this).html(e.trim(o.result)).slideDown("slow")})});else{var i=e(o.result).attr("style","display: none");t.append(i),e(".remembercount").html(o.count),n.length&&n.each(function(){var t=i.clone();e(this).append(t),t.slideDown("slow")}),i.slideDown("slow")}o.debug&&e(".rememberdebug").html(o.debug)}})},onDelete:function(t,n,o,i){e.ajax({type:"GET",url:this.options.connectorUrl,data:{language:this.options.language,action:"remember",delete:i},success:function(i){if(i.count&&"0"!==i.count){var s=e(o).parent(),a=s.index();s.slideUp("slow",function(){e(".remembercount").html(i.count),e(this).remove()}),n.length&&n.each(function(){e(this).children().eq(a).slideUp("slow",function(){e(this).remove()})})}else t.slideUp("slow",function(){e(".remembercount").html(i.count),e(this).html(e.trim(i.result)).slideDown("fast")}),n.length&&n.each(function(){e(this).slideUp("slow",function(){e(this).html(e.trim(i.result)).slideDown("fast")})});i.debug&&e(".rememberdebug").html(i.debug)}})}},e.fn[i]=function(t){var n,o=arguments;if(void 0===t||"object"==typeof t){var s=!0;return this.each(function(){e.data(this,"plugin_"+i)||e.data(this,"plugin_"+i,new a(this,t,s)),s=!1})}if("string"==typeof t&&"_"!==t[0]&&"init"!==t)return this.each(function(){var s=e.data(this,"plugin_"+i);s instanceof a&&"function"==typeof s[t]&&(n=s[t].apply(s,Array.prototype.slice.call(o,1))),"destroy"===t&&e.data(this,"plugin_"+i,null)}),void 0!==n?n:this}}(jQuery,window,document);